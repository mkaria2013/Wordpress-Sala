!function(e){"use strict";e.WS_Form.prototype.form_select2=function(t){void 0===t&&(t=e("[data-wsf-select2]",this.form_canvas_obj));var a=this;void 0!==jQuery().select2&&t.each(function(){var t=a.get_field_id(e(this)),s=a.get_field(e(this)),r=a.get_object_meta_value(s,"placeholder_row",""),i=ws_form_settings.locale.substring(0,2),n={};a.form_select2_language_add(n,s,"select2_language_error_loading","errorLoading"),a.form_select2_language_add(n,s,"select2_language_input_too_short","inputTooShort"),a.form_select2_language_add(n,s,"select2_language_input_too_long","inputTooLong"),a.form_select2_language_add(n,s,"select2_language_no_results","noResults"),a.form_select2_language_add(n,s,"select2_language_searching","searching"),Object.keys(n).length&&(i=n);var o=ws_form_settings.url_ajax+"field/"+t+"/select-ajax/",l={templateSelection:function(t){return void 0!==t.data_price&&e(t.element).attr("data-price",t.data_price),t.text},allowClear:!0,placeholder:r,language:i,selectionCssClass:"wsf-select2-selection",dropdownCssClass:"wsf-select2-dropdown",dropdownParent:e(this).parent()},_=a.get_object_meta_value(s,"select2_minimum_input_length","");""!=_&&(l.minimumInputLength=parseInt(_,10));var c=a.get_object_meta_value(s,"select2_maximum_input_length","");if(""!=c&&(l.maximumInputLength=parseInt(c,10)),!("on"==a.get_object_meta_value(s,s.type+"_cascade",""))&&"on"==a.get_object_meta_value(s,"select2_ajax","")){var d=e(this);l.ajax={url:o,dataType:"json",data:function(t){var s={id:a.form_id,preview:a.form_canvas_obj[0].hasAttribute("data-preview"),keyword:t.term};if(void 0!==e(this).attr("data-wsf-populate")){var r=e(this).attr("data-wsf-populate");""!==r&&(s.value=r),void 0===e(this).attr("data-cascade-ajax")&&e(this).removeAttr("data-wsf-populate")}return ws_form_settings.wsf_nonce&&(s[ws_form_settings.wsf_nonce_field_name]=ws_form_settings.wsf_nonce),ws_form_settings.x_wp_nonce&&(s._wpnonce=ws_form_settings.x_wp_nonce),s},processResults:function(e){return e.results&&e.results.length?d.attr("data-select2-ajax-results",""):d.removeAttr("data-select2-ajax-results"),d.trigger("wsf-select2-ajax-results"),e},delay:250,cache:!0}}var u,m="on"==a.get_object_meta_value(s,"multiple",""),p="on"==a.get_object_meta_value(s,"select2_tags","");(m&&p&&(l.tags=!0),u=e(this).closest('[data-type="select"]').attr("data-select-max"))&&((u=parseInt(u,10))>0&&(l.maximumSelectionLength=u));var g=e(this).select2(l);g.on("select2:open",function(t){e(".select2-search__field",e(this).parent()).get(0).focus()});var f=void 0!==e(this).attr("data-wsf-populate")?e(this).attr("data-wsf-populate"):"";if(""!==f){var h=new FormData;h.append("id",a.form_id),h.append("preview",a.form_canvas_obj[0].hasAttribute("data-preview")),h.append("value",f),a.api_call("field/"+t+"/select-ajax/","GET",h,function(t){if(t.results){for(var a in t.results)if(t.results.hasOwnProperty(a)){var s=t.results[a];if(void 0!==s.children){var r=e("<optgroup>");r.attr("label",s.text);var i=g.append(r);for(var n in s.children)if(s.children.hasOwnProperty(n)){var o=s.children[n];(l=e("<option>")).attr("value",o.id).attr("selected","").html(o.text),i.append(l)}}else{var l;(l=e("<option>")).attr("value",s.id).attr("selected","").html(s.text),g.append(l)}}g.trigger("change")}})}})},e.WS_Form.prototype.form_select2_language_add=function(e,t,a,s){var r=this.get_object_meta_value(t,a,"");if(""!=r){var i=this;e[s]=function(e){var t={};switch(s){case"searching":t.term=void 0!==e.term?e.term:"";break;case"inputTooShort":t.term=void 0!==e.input?e.input:"";var a=e.minimum-e.input.length;t.char_remaining=a,t.char_plural=1!=a?"s":"";break;case"inputTooLong":t.term=void 0!==e.input?e.input:"";var n=e.input.length-e.maximum;t.char_over=n,t.char_plural=1!=n?"s":""}return i.mask_parse(r,t)}}},e.WS_Form.prototype.form_select_min_max=function(){var t=this;e("[data-select-min]:not([data-select-min-max-init]),[data-select-max]:not([data-select-min-max-init])",this.form_canvas_obj).each(function(){var a=e(this).attr("data-select-min"),s=e(this).attr("data-select-max");if(void 0!==a||void 0!==s){var r=e(this).attr("data-id"),i=t.get_section_repeatable_suffix(e(this)),n=e('<input type="number" id="'+t.esc_attr(t.form_id_prefix+"select-min-max-"+r+i)+'" data-select-min-max data-progress-include="change" style="display: none !important;" aria-label="Validator" />',t.form_canvas_obj);void 0!==a&&n.attr("min",a),void 0!==s&&n.attr("max",s),s=parseInt(s,10);var o=e("select option:selected",e(this)).length;n.attr("value",o);var l=t.get_invalid_feedback_obj(e(this));l.length?l.before(n):e(this).append(n),e("select",e(this)).on("change",function(){var a=t.get_field_wrapper(e(this)),s=t.get_field_id(e(this)),r=t.get_section_repeatable_suffix(e(this)),i=e("select option:selected",a).length;e("#"+t.form_id_prefix+"select-min-max-"+s+r,t.form_canvas_obj).val(i).trigger("change")}),e(this).attr("data-select-min-max-init","")}})}}(jQuery);